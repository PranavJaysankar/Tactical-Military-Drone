<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body{
            background-color:gainsboro;
        }
        /* Style for the camera display row */
        .camera-row {
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin-bottom: 20px;
            text-align: center;
        }
        .buttonforcamera {
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin: 20px;
        }

        /* Style for the camera container */
        .camera-container {
            border: 2px solid black;
            padding: 10px;
            width: 300px;
            height: 200px;
            position: relative;
            text-align: center; /* Center the content inside the container */
        }

        /* Style for the video elements */
        video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* Style for the "Activate" button */
        .activate-button {
            display: inline-block;
            padding: 10px 20px;
            font-size: 20px;
            cursor: pointer;
            text-align: center;
            text-decoration: none;
            outline: none;
            color: #fff;
            background-color: black;
            border: none;
            border-radius: 15px;
            box-shadow: 0 9px #999;
        }

        .activate-button:hover {background-color: #2d7c2f}

        .activate-button:active {
            background-color: #2d7c2f;
            box-shadow: 0 5px #666;
            transform: translateY(4px);
        }
        .con-button {
  position: relative;
  background: black;
  color: #fff;
  text-decoration: none;
  text-transform: uppercase;
  border: none;
  letter-spacing: 0.1rem;
  font-size: 1rem;
  padding: 1rem 3rem;
  transition: 0.2s;
}

.con-button:hover {
  letter-spacing: 0.2rem;
  padding: 1.1rem 3.1rem;
  background: var(--clr);
  color: var(--clr);
  /* box-shadow: 0 0 35px var(--clr); */
  animation: box 3s infinite;
}

.con-button::before {
  content: "";
  position: absolute;
  inset: 2px;
  background: black;
}

.con-button span {
  position: relative;
  z-index: 1;
}
.con-button i {
  position: absolute;
  inset: 0;
  display: block;
}

.con-button i::before {
  content: "";
  position: absolute;
  width: 10px;
  height: 2px;
  left: 80%;
  top: -2px;
  border: 2px solid var(--clr);
  background: black;
  transition: 0.2s;
}

.con-button:hover i::before {
  width: 15px;
  left: 20%;
  animation: move 3s infinite;
}

.con-button i::after {
  content: "";
  position: absolute;
  width: 10px;
  height: 2px;
  left: 20%;
  bottom: -2px;
  border: 2px solid var(--clr);
  background: black;
  transition: 0.2s;
}

.con-button:hover i::after {
  width: 15px;
  left: 80%;
  animation: move 3s infinite;
}

@keyframes move {
  0% {
    transform: translateX(0);
  }
  50% {
    transform: translateX(5px);
  }
  100% {
    transform: translateX(0);
  }
}

@keyframes box {
  0% {
    box-shadow: #27272c;
  }
  50% {
    box-shadow: 0 0 25px var(--clr);
  }
  100% {
    box-shadow: #27272c;
  }
}
.rot-button {
  --c:  #229091; /* the color*/
  
  box-shadow: 0 0 0 .1em inset var(--c); 
  --_g: linear-gradient(var(--c) 0 0) no-repeat;
  background: 
    var(--_g) calc(var(--_p,0%) - 100%) 0%,
    var(--_g) calc(200% - var(--_p,0%)) 0%,
    var(--_g) calc(var(--_p,0%) - 100%) 100%,
    var(--_g) calc(200% - var(--_p,0%)) 100%;
  background-size: 50.5% calc(var(--_p,0%)/2 + .5%);
  outline-offset: .1em;
  transition: background-size .4s, background-position 0s .4s;
}
.rot-button:hover {
  --_p: 100%;
  transition: background-position .4s, background-size 0s;
}
.rot-button:active {
  box-shadow: 0 0 9e9q inset #0009; 
  background-color: var(--c);
  color: #fff;
}
        
        /* Style for the input box */
        #altitudeInput {
            margin-top: 20px;
        }

        /* Style for the controller buttons */
        .controller {
            margin-top: 20px;
            display: flex;
            justify-content: center;
        }

        /* Style for the on/off switch */
        .switch {
            display: flex;
            height: 10vh;
            justify-content: center;
        }
        #altitudeInput {
        margin-top: 20px;
        display: block;
        margin-left: auto;
        margin-right: auto;
        margin-top: 40px;
        margin-bottom: 20px;
        }
        .controls-container {
        display: flex;
        justify-content: space-between;
        }
        .controller {
        margin-top: 20px;
        display: flex;
        margin-left: 30px;
        justify-content: flex-start; /* Align controls to the left */
        }
        #controls {
         display: inline-grid;
         grid-column-gap: 10;
         align-self: end;
        }
        #keyboard_key_up {
         grid-column-start: 2;
         margin-bottom: 20PX;
        }

        #keyboard_key_left {
            grid-column-start: 1;
            margin-right: 10px;
        }

        #keyboard_key_down {
            margin-top: 20px;
        }

        #keyboard_key_right {
            grid-column-start: 3;
            margin-left: 10px;
            }

        /* Style for the rotation buttons */
        .rotate-buttons {
            margin-top: 20px;
            
            display: flex;
            justify-content: flex-end;
            margin-right: 20px;

        }
        .rotate-buttons button {
            margin-left: 10px;
        }
        /* Style for RPM Controls */
        .rpm-controls {
        margin-top: 20px;
        text-align: center;
        }

    /* Style for RPM Slider and Input */
        #rpmSlider,
        #rpmInput {
        width: 150px;
        margin: 5px;
        }
    </style>

    <title>Your Website</title>
</head>
<body>

<!-- Camera Display Row -->
<div class="camera-row">
    <div class="camera-container" id="frontDisplay">
        <img src="default_image_front.jpg" alt="Default Image">
    </div>
    

    <div class="camera-container" id="rearLeftDisplay">
        <img src="default_image_left.jpg" alt="Default Image">
    </div>
    

    <div class="camera-container" id="rearRightDisplay">
        <img src="default_image_right.jpg" alt="Default Image">
    </div>
    
</div>
<div class="buttonforcamera">
    <button class="activate-button" onclick="activateCamera('front')">Activate Front Camera</button>
    <button class="activate-button" style="margin-left: 40px;" onclick="activateCamera('rearLeft')">Activate Rear Left Camera</button>
    <button class="activate-button" style="margin-right: -20px;margin-left: 15px;" onclick="activateCamera('rearRight')">Activate Rear Right Camera</button>
</div>

<!-- Altitude Input Box -->

<input type="text" id="altitudeInput" placeholder="Enter Altitude">


<!-- Controller Buttons -->
<div class="controls-container">
<div class="controller">
    <div id="controls">
        <button id="keyboard_key_up" class="con-button" style="--clr:#39FF14"><span>FORWARD</span></button>
        <button id="keyboard_key_left" class="con-button" style="--clr:#FF44CC"><span>LEFT</span></button>
        <button id="keyboard_key_down" class="con-button" style="--clr:#0FF0FC"><span>DOWNWARD</span></button>
        <button id="keyboard_key_right" class="con-button" style="--clr:#8A2BE2"><span>RIGHT</span></button>
    </div>
</div>



<!-- Rotation Buttons -->
<div class="rotate-buttons">
    <button class="rot-button" onclick="rotate('anticlockwise')"><b>ANTICLOCKWISE</button>
    <button class="rot-button" style="--c:#E95A49" onclick="rotate('clockwise')">CLOCKWISE</b></button>
</div>
</div>
<!-- On/Off Switch -->
<div class="switch">
    <label>On/Off
        <input type="checkbox" id="onOffSwitch">
    </label>
</div>


<!-- RPM Controls -->
<div class="rpm-controls">
    <!-- RPM Slider -->
    <label for="rpmSlider">Set RPM:</label>
    <input type="range" id="rpmSlider" min="0" max="8000" value="3000" oninput="updateRPMFromSlider(this.value)">

    <!-- RPM Input Box -->
    <label for="rpmInput">Manual RPM:</label>
    <input type="number" id="rpmInput" value="3000" oninput="updateRPMFromInput(this.value)">
</div>

<!-- RPM Meter Container -->
<div class="rpm-meter-container">
    <!-- RPM Meter -->
    <div class="rpm-meter" id="rpmMeter">
        <!-- RPM Indicator -->
        <div class="rpm-indicator" id="rpmIndicator"></div>
    </div>
</div>

<script>
    var cameraStreams = {
        front: null,
        rearLeft: null,
        rearRight: null,
    };

    function activateCamera(display) {
        var displayElement = document.getElementById(display + 'Display');

        if (cameraStreams[display]) {
            // If the camera is already active, deactivate it
            stopCamera(display);
            displayElement.innerHTML = '<img src="default_image_' + display + '.jpg" alt="Default Image">';
        } else {
            // If the camera is not active, activate it
            chooseCamera(display);
        }
    }

    function chooseCamera(display) {
        navigator.mediaDevices.enumerateDevices()
            .then(function (devices) {
                var videoDevices = devices.filter(device => device.kind === 'videoinput');
                
                if (videoDevices.length > 0) {
                    // Display a list of available cameras for the user to choose from
                    var cameraList = videoDevices.map(device => ({
                        label: device.label || 'Camera ' + (videoDevices.indexOf(device) + 1),
                        deviceId: device.deviceId,
                    }));

                    var selectedCamera = prompt('Select camera for ' + display + ': \n' +
                        cameraList.map((camera, index) => index + 1 + '. ' + camera.label).join('\n'));

                    if (selectedCamera !== null) {
                        // User selected a camera, start it
                        startCamera(display, cameraList[selectedCamera - 1].deviceId);
                    }
                } else {
                    alert('No video devices found.');
                }
            })
            .catch(function (error) {
                console.error('Error enumerating devices:', error);
            });
    }

    function startCamera(display, deviceId) {
        if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
            navigator.mediaDevices
                .getUserMedia({ video: { facingMode: display === 'front' ? 'user' : 'environment', deviceId: deviceId } })
                .then(function (stream) {
                    cameraStreams[display] = stream;

                    const video = document.createElement('video');
                    video.srcObject = stream;
                    video.play();

                    const displayElement = document.getElementById(display + 'Display');
                    displayElement.innerHTML = '';
                    displayElement.appendChild(video);
                })
                .catch(function (error) {
                    console.error('Error accessing camera:', error);
                });
        } else {
            alert('getUserMedia not supported in this browser.');
        }
    }

    function stopCamera(display) {
        if (cameraStreams[display]) {
            var tracks = cameraStreams[display].getTracks();
            tracks.forEach(function (track) {
                track.stop();
            });
            cameraStreams[display] = null;
        }
    }

    function move(direction) {
        // Implement movement logic based on direction
        console.log('Move ' + direction);
    }

    function rotate(rotation) {
        // Implement rotation logic based on rotation direction
        console.log('Rotate ' + rotation);
    }
    function updateRPM(value) {
        // Update the RPM Meter
        updateRPMIndicator(value);

        // Send HTTP POST request to Raspberry Pi
        fetch('http://192.168.1.103:5000/update_rpm', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ rpm: value }),
        })
        .then(response => response.json())
        .then(data => {
            console.log('Server response:', data);
        })
        .catch(error => {
            console.error('Error:', error);
        });
    }

    function updateRPMFromSlider(value) {
        // Update the RPM Input Box
        document.getElementById('rpmInput').value = value;

        // Update the RPM Meter and send HTTP request
        updateRPM(value);
    }

    function updateRPMFromInput(value) {
        // Ensure the entered value is within the RPM range
        var rpm = Math.min(8000, Math.max(0, value));

        // Update the RPM Slider
        document.getElementById('rpmSlider').value = rpm;

        // Update the RPM Meter and send HTTP request
        updateRPM(rpm);
    }
</script>

</body>
</html>